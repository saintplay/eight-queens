var Application;!function(t){var i=function(){function t(){}return t.initElements=function(){t.rollback_button=$("#rollback-button"),t.play_button=$("#play-button"),t.restart_button=$("#restart-button"),t.time_counter=$("#time-counter")},t}();t._$=i;var n=function(){function t(){}return t}();n.FIN_TIEMPO=0,n.JUGADA_CORRECTA=10,n.JUGADA_INCORRECTA=-5,n.USAR_ROLLBACK=0,t.Puntajes=n;var a=function(){function t(){}return t}();a.NUMERO_JUGADORES=2,a.TAMANIO_DE_TABLERO=8,a.MAS_INFINITO=1e3,a.MENOS_INFINO=-1e3,t.Globales=a;!function(t){t[t.GanaHumano=-10]="GanaHumano",t[t.Empate=0]="Empate",t[t.GanaMaquina=10]="GanaMaquina"}(t.Utilidad||(t.Utilidad={}))}(Application||(Application={}));var Application;!function(t){var i;!function(t){t[t.JugadorA=0]="JugadorA",t[t.JugadorB=1]="JugadorB"}(i=t.JugadorKey||(t.JugadorKey={}));var n=function(){function n(){this._jugador_actual_key=i.JugadorA}return Object.defineProperty(n.prototype,"jugador_key",{get:function(){return this._jugador_actual_key},set:function(t){this._jugador_actual_key=t},enumerable:!0,configurable:!0}),n.prototype.cambiar=function(){this._jugador_actual_key+1==t.Globales.NUMERO_JUGADORES?this._jugador_actual_key:this._jugador_actual_key++},n}();t.Turno=n}(Application||(Application={}));var Application;!function(t){var i=function(){function t(t,i){this.fila=t,this.columna=i}return t}();t.Casillero=i;var n=function(){function n(){this.filas=t.Globales.TAMANIO_DE_TABLERO,this.columnas=t.Globales.TAMANIO_DE_TABLERO,this.disponibles=[],this.insertadas=[]}return n.prototype.ObtenerUtilidad=function(){return this.insertadas.length==t.Globales.TAMANIO_DE_TABLERO?t.Utilidad.Empate:t.turno.jugador_key==t.JugadorKey.JugadorB?t.Utilidad.GanaMaquina:t.Utilidad.GanaHumano},n.prototype.esTerminal=function(){return 0==this.disponibles.length},n.prototype.ObtenerDisponibles=function(){return this.disponibles},n.prototype.insertarReina=function(t){for(var i=0;i<this.disponibles.length;i++)this.disponibles[i].columna!=t.columna&&this.disponibles[i].fila!=t.fila?Math.abs(this.disponibles[i].fila-t.fila)!=Math.abs(this.disponibles[i].columna-t.columna)||(this.disponibles.splice(i,1),i--):(this.disponibles.splice(i,1),i--);this.insertadas.push(t)},n.prototype.inicializarDisponibles=function(){this.disponibles=[];for(var t=0;t<this.filas;t++)for(var n=0;n<this.columnas;n++)this.disponibles.push(new i(t,n))},n.prototype.hacerCopia=function(){var t=new n;t.filas=this.filas,t.columnas=this.columnas,t.disponibles=[],t.insertadas=[];for(var a=0,o=this.disponibles;a<o.length;a++){var e=o[a];t.disponibles.push(new i(e.fila,e.columna))}for(var r=0,l=this.insertadas;r<l.length;r++){var u=l[r];t.insertadas.push(new i(u.fila,u.columna))}return t},n}();t.Tablero=n}(Application||(Application={}));var Application;!function(t){var i=function(){function t(t){this.utilidad=t}return t}();t.Nodo=i;var n=function(){function n(){}return n.prototype.mejorJugada=function(n,a,o,e){if(n.esTerminal()){var r=n.ObtenerUtilidad();return new i(r)}for(var l=new i(t.Globales.MENOS_INFINO),u=0,s=n.ObtenerDisponibles();u<s.length;u++){var c=s[u],p=n.hacerCopia();p.insertarReina(c);var d=this.peorJugada(p,a-1,o,e);if(l.utilidad=Math.max(l.utilidad,d.utilidad),l.casillero=c,l.utilidad>=e)return l;e=Math.max(e,l.utilidad)}return l},n.prototype.peorJugada=function(n,a,o,e){if(n.esTerminal()){var r=n.ObtenerUtilidad();return new i(r)}for(var l=new i(t.Globales.MAS_INFINITO),u=0,s=n.ObtenerDisponibles();u<s.length;u++){var c=s[u],p=$.extend(!0,{},n);p.insertarReina(c);var d=this.mejorJugada(p,a-1,o,e);if(l.utilidad=Math.min(l.utilidad,d.utilidad),l.casillero=c,l.utilidad<=o)return l;e=Math.min(e,l.utilidad)}return l},n}();t.AlfaBetaPruning=n}(Application||(Application={}));var Application;!function(t){var i=function(){function i(t){this._es_ia=!1,this.puntos=0,this._icono=$(t)}return Object.defineProperty(i.prototype,"EsIA",{get:function(){return this._es_ia},set:function(t){this._es_ia=t},enumerable:!0,configurable:!0}),i.prototype.empezarTurno=function(){if(this._icono.addClass("jugador-activo"),this._es_ia){var i=t.abp.mejorJugada(t.tablero,8,t.Globales.MENOS_INFINO,t.Globales.MAS_INFINITO);t.tablero.insertarReina(i.casillero),$("td[fila="+i.casillero.fila+"][columna="+i.casillero.columna+"]").addClass("queen-images")}},i.prototype.llegaAlLimiteDeTiempo=function(){this.puntos-=t.Puntajes.FIN_TIEMPO,this.terminaTurno()},i.prototype.terminaTurno=function(){this._icono.removeClass("jugador-activo"),this.alTerminar()},i}();t.Jugador=i}(Application||(Application={}));var Application;!function(t){var i=function(){function t(){this._interval_handle=null,t.$time_counter=$("#time-counter")}return Object.defineProperty(t.prototype,"time",{get:function(){return this._time},set:function(t){this._time=t},enumerable:!0,configurable:!0}),t.prototype.mostrarTiempo=function(){t.$time_counter.text(this._time)},t.prototype.descontarTiempo=function(){this._time--,this.mostrarTiempo(),this._time==t.TIEMPO_FIN&&t.alAcabarse()},t.prototype.empezarContador=function(){this._time=t.SEGUNDOS,this.mostrarTiempo(),this._interval_handle=setInterval(this.descontarTiempo.bind(this),1e3)},t.prototype.terminarContador=function(){null!=this._interval_handle&&clearInterval(this._interval_handle)},t}();i.SEGUNDOS=5,i.TIEMPO_FIN=-1,t.TimeController=i}(Application||(Application={}));var Application;!function(t){var i,n,a,o,e=function(){function n(){}return n.siguienteTurno=function(n){void 0===n&&(n=!0),1==n&&t.turno.cambiar();var a=o[t.turno.jugador_key];t.TimeController.alAcabarse=a.llegaAlLimiteDeTiempo.bind(a),i.terminarContador(),i.empezarContador(),a.empezarTurno()},n}();$(function(){t._$.initElements(),i=new t.TimeController,t.turno=new t.Turno,t.abp=new t.AlfaBetaPruning,t.tablero=new t.Tablero,t.tablero.inicializarDisponibles(),n=new t.Jugador("#human-icono"),a=new t.Jugador("#robot-icono"),o=[n,a],a.EsIA=!0,t.turno.jugador_key=t.JugadorKey.JugadorA,n.alTerminar=e.siguienteTurno,a.alTerminar=e.siguienteTurno,t._$.play_button.on("click",function(){i.empezarContador(),e.siguienteTurno(!1)}),t._$.rollback_button.on("click",function(){t._$.rollback_button.hide(),$("#human-box .rb-status").addClass("rb-used")}),t._$.restart_button.on("click",function(){t._$.rollback_button.hide(),$("td").removeClass("queen-images"),$("#human-box .rb-status").removeClass("rb-used"),t._$.rollback_button.show()}),$("td").on("click",function(){$(this).addClass("queen-images");var i=parseInt($(this).attr("fila")),n=parseInt($(this).attr("columna"));t.tablero.insertarReina(new t.Casillero(i,n)),console.log(t.tablero)})})}(Application||(Application={}));